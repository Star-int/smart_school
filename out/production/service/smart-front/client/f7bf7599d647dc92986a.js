(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{361:function(e,t,n){"use strict";var l=n(88),o="/application/student";t.a={getStudentInfoByUserId:function(e){return Object(l.a)({url:"".concat(o,"/getStudentInfoByUserId/").concat(e),method:"get"})},addStudent:function(e){return Object(l.a)({url:"".concat(o,"/addStudent"),method:"post",data:e})},getUndefineStudent:function(){return Object(l.a)({url:"".concat(o,"/getUndefineStuedentInfo"),method:"get"})},updateStudent:function(e){return Object(l.a)({url:"".concat(o,"/updateStudent"),method:"put",data:e})}}},381:function(e,t,n){"use strict";var l=n(88),o="/application/leave";t.a={getAllLeavePage:function(e,t,n){return Object(l.a)({url:"".concat(o,"/getAllLeavePage/").concat(e,"/").concat(t),method:"get",params:n})},getPageById:function(e,t,n){return Object(l.a)({url:"".concat(o,"/getAllLeaveByIdPage/").concat(e,"/").concat(t),method:"get",params:n})},getLeaveById:function(e){return Object(l.a)({url:"".concat(o,"/getLeaveInfoById/").concat(e),method:"get"})},deleteLeaveById:function(e){return Object(l.a)({url:"".concat(o,"/deleteLeaveById/").concat(e),method:"delete"})},updateLeave:function(e){return Object(l.a)({url:"".concat(o,"/updateLeave"),method:"put",data:e})},deleteBrach:function(e){return Object(l.a)({url:"".concat(o,"/deleteBrach"),method:"delete",data:e})},addLeave:function(e){return Object(l.a)({url:"".concat(o,"/addLeave"),method:"post",data:e})}}},462:function(e,t,n){"use strict";n.r(t);n(44);var l=n(381),o=n(361),r=n(25),c=n.n(r),d={data:function(){return{user:{},dialogVisible:!1,selectedLeaves:[],searchObj:{},leaveList:[],leaveInfo:[],page:1,limit:10,total:0,studentId:""}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.getUserInfo(),this.page=t,o.a.getStudentInfoByUserId(this.user.id).then((function(t){e.studentId=t.data.data.items.studentId,console.log("学生id为"+e.studentId),e.searchObj.studentId=e.studentId,l.a.getPageById(e.page,e.limit,e.searchObj).then((function(t){e.leaveList=t.data.data.items.records,console.log(JSON.stringify(e.searchObj)),e.total=t.data.data.items.total}))}))},getUserInfo:function(){var e=c.a.get("guli_ucenter");if(e)try{this.user=JSON.parse(e),console.log("成功解析 JSON 数据")}catch(e){console.error("JSON 解析失败:",e)}},resetData:function(){this.searchObj.studentId=this.studentId,this.fetchData()},handleApproval:function(e,t){var n=this;1!=t?this.dialogVisible=!0:this.$message({message:"已通过，无法修改",type:"warning"}),l.a.getLeaveById(e).then((function(e){n.leaveInfo=e.data.data.items}))},handleSelectionChange:function(e){this.selectedLeaves=e},handleBatchDelete:function(){var e=this;0!==this.selectedLeaves.length?this.$confirm("此操作将永久删除这些信息，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var t=e.selectedLeaves.map((function(e){return e.id}));l.a.deleteBrach(t).then((function(t){e.$message({type:"success",message:"删除成功!"}),e.fetchData(e.page)})).catch((function(t){e.$message({type:"error",message:"删除失败!"})}))})):this.$message({type:"warning",message:"请选择要删除的记录!"})},updateLeave:function(){var e=this;this.leaveInfo.status="0",l.a.updateLeave(this.leaveInfo).then((function(t){e.$message({type:"success",message:"修改成功"}),e.dialogVisible=!1,e.fetchData()}))},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){l.a.deleteLeaveById(e).then((function(e){t.$message({type:"success",message:"删除成功"}),t.fetchData(t.page)})).catch((function(e){t.$message({type:"error",message:"删除失败"})}))}))}}},f=n(19),component=Object(f.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"leave-list-page"},[n("h1",[e._v("请假记录")]),e._v(" "),n("el-button",{attrs:{type:"danger"},on:{click:e.handleBatchDelete}},[e._v("批量删除")]),e._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.leaveList,border:""},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{label:"序号",width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("i",{staticClass:"el-icon"}),e._v(" "),n("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s((e.page-1)*e.limit+t.$index+1))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"学生姓名",width:"100px",prop:"studentName"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.studentName))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"请假类型",width:"100px",prop:"leaveType"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.leaveType))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"原因",prop:"reason",width:"130px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.reason,placement:"top-start"}},[n("span",[e._v(e._s(t.row.reason.length>6?t.row.reason.substring(0,6)+"...":t.row.reason))])])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"开始日期",width:"150px",prop:"startDate"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.startDate))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"结束日期",width:"150px",prop:"endDate"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(t.row.endDate))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"状态",prop:"status",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.status?n("el-tag",{attrs:{type:"info"}},[e._v("未审批")]):e._e(),e._v(" "),1==t.row.status?n("el-tag",{attrs:{type:"success"}},[e._v("通过")]):e._e(),e._v(" "),2==t.row.status?n("el-tag",{attrs:{type:"danger"}},[e._v("未通过")]):e._e()]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"意见",prop:"comment",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.row.comment,placement:"top-start"}},[n("span",[e._v(e._s(t.row.comment.length>6?t.row.comment.substring(0,6)+"...":t.row.comment))])])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit"},on:{click:function(n){return e.handleApproval(t.row.id,t.row.status)}}},[e._v("修改")]),e._v(" "),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){return e.handleDelete(t.row.id)}}},[e._v("删除")])]}}])})],1),e._v(" "),n("el-dialog",{attrs:{title:"修改请假信息",visible:e.dialogVisible},on:{"update:visible":function(t){e.dialogVisible=t}}},[n("el-form",{attrs:{model:e.leaveInfo,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"学生姓名"}},[n("el-input",{attrs:{disabled:""},model:{value:e.leaveInfo.studentName,callback:function(t){e.$set(e.leaveInfo,"studentName",t)},expression:"leaveInfo.studentName"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"开始日期"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"00:00:00"},model:{value:e.leaveInfo.startDate,callback:function(t){e.$set(e.leaveInfo,"startDate",t)},expression:"leaveInfo.startDate"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"结束日期"}},[n("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":"00:00:00"},model:{value:e.leaveInfo.endDate,callback:function(t){e.$set(e.leaveInfo,"endDate",t)},expression:"leaveInfo.endDate"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"请假类型"}},[n("el-select",{attrs:{placeholder:"请选择请假类型"},model:{value:e.leaveInfo.leaveType,callback:function(t){e.$set(e.leaveInfo,"leaveType",t)},expression:"leaveInfo.leaveType"}},[n("el-option",{attrs:{label:"病假",value:"病假"}}),e._v(" "),n("el-option",{attrs:{label:"事假",value:"事假"}}),e._v(" "),n("el-option",{attrs:{label:"探亲假",value:"探亲假"}}),e._v(" "),n("el-option",{attrs:{label:"婚假",value:"婚假"}}),e._v(" "),n("el-option",{attrs:{label:"丧假",value:"丧假"}})],1)],1),e._v(" "),n("el-form-item",{attrs:{label:"请假原因"}},[n("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入请假原因"},model:{value:e.leaveInfo.reason,callback:function(t){e.$set(e.leaveInfo,"reason",t)},expression:"leaveInfo.reason"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"审批意见"}},[n("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入审批意见",disabled:""},model:{value:e.leaveInfo.comment,callback:function(t){e.$set(e.leaveInfo,"comment",t)},expression:"leaveInfo.comment"}})],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:e.updateLeave}},[e._v("确 定")])],1)],1),e._v(" "),n("el-pagination",{staticStyle:{padding:"30px 0","text-align":"center"},attrs:{"current-page":e.page,"page-size":e.limit,total:parseInt(e.total),layout:"total, prev, pager, next, jumper"},on:{"current-change":e.fetchData}})],1)}),[],!1,null,null,null);t.default=component.exports}}]);